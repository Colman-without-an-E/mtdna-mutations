# The Site Frequency Spectrum Distinguishes the Mechanisms Behind Accumulation of mtDNA Mutations

## Overview
This repository contains the code used for my final year project, which is a requirement for the completion of my master's degree in Mathematics. In this project, we proposed the novel method of using the site frequency spectrum to distinguish the mechanisms behind the accumulation of mtDNA long deletion mutations. Our findings suggest that the site frequency spectrum is different under two models exhibiting different mechanisms, and reliably distinguishes them, offering new insights into age-related diseases and broader biological models. 

## Repository Structure
The repository is organized into several directories to separate different components of the project, making it easier to navigate and maintain.

- `include/`: Contains the C header files which declare functions, macros, data types, and parameter values used across the C source files. 
- `src/`: Contains the C source files that simulate the replication and degradation of mtDNA molecules in a cell. 
- `data_analysis/`: Contains Python scripts used for analysing the data generated by the simulations. 
- `no_sfs/`: Contains additional files and scripts related to the project but not the primary focus of the simulations and analysis. 

Usage of each file can be found in the README.md in each directory. 

## Getting Started

### Prerequisites
- List of required software and libraries:
  - GCC (https://gcc.gnu.org/install/)
  - Python (version 3.x)
  - Python libraries: NumPy, SciPy, pandas, matplotlib

### Installation
1. **Clone the repository:**
    ```bash
    git clone https://github.com/Colman-without-an-E/mtdna-mutations.git
    ```
2. **Navigate to the project directory**
    ```bash
    cd mtdna-mutations
    ```

### Example Usage
1. **Compile the C programs**
    - Navigate to the `src/` directory
    ```bash
    cd src
    ```
    - Compile the source files
    ```bash
    gcc ra_single_sim.c lib_sim.c -o ra_single_sim.exe -lgsl -lgslcblas -lm
    ```
2. **Execute the simulations**
    ```bash
    ./ra_single_sim.exe 1
    ./ra_single_sim.exe 2
    ```
Here, two simulations with seed 1 and 2 under the replicative advantage (RA) model is performed using the parameter values specified in `include/parameters.h`. A new directory `src/parameters_set1` containing the simulation results `ra_sim_populations1.txt`, `ra_sim_site_frequency_spectrum1.txt`, `ra_sim_populations2.txt`, `ra_sim_site_frequency_spectrum2.txt`, and a list of parameter values `parameters.txt` is created. 

### Performing Data Analysis
1. **Copy simulations data to directory for data analysis**
    ```bash
    cd
    cp src/parameters_set1/ra_sim*.txt data_analysis/
    cd data_analysis
    ```
2. **Compile simulations data**
    ```bash
    python compile_data.py 1 ra pop
    python compile_data.py 1 ra sfs
    ```
    Pandas dataframes `parameters_set1_ra_pop_master.pkl` and `parameters_set1_ra_sfs_master.pkl` are generated and saved. These dataframes contain compiled data from the 2 simulations. 
3. **Combine populations data and site frequency spectrum data**
    ```bash
    python combine_pop_sfs.py 1 ra
    ```
    Pandas dataframe `parameters_set1_ra_combined_master.pkl` is generated and saved. 
4. **Ensemble data**
    ```bash
    python ensemble_data.py 1 ra 1.0
    ```
    Pandas dataframes `parameters_set1_ra_h_100.pkl` and `parameters_set1_ra_sfs_100.pkl` containing the ensembled mutant fraction and site frequency spectrum across simulations. These dataframes are usually small enough in size that they can be copied back to your local machine. 
5. **Visualise data**
    - Plot mutant fraction against time
    ```bash
    python example_plot_h.py
    ```
    - Plot site frequency spectrum
    ```bash
    python example_plot_sfs.py
    ```
6. **Performing statistical tests**

    Suppose in addition to simulations under the RA model, the above steps are also taken to simulate, compile, and ensemble data under the stochastic survival of the densest (SSD) model, obtaining the Pandas dataframe `parameters_set1_ssd_sfs_100.pkl`. Then, the following command can be run to perform a Mann-Whitney U test on the difference of site frequency spectra under the RA model and SSD model. 
    ```bash
    python example_mann-whitney.py
    ```